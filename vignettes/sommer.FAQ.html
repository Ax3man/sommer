<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Giovanny Covarrubias-Pazaran" />

<meta name="date" content="2019-04-17" />

<title>Frequently asked questions for the sommer package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; min-height: 1.25em; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; }
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
@media screen {
a.sourceLine::before { text-decoration: underline; color: initial; }
}
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.bn { color: #40a070; } /* BaseN */
code span.fl { color: #40a070; } /* Float */
code span.ch { color: #4070a0; } /* Char */
code span.st { color: #4070a0; } /* String */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.ot { color: #007020; } /* Other */
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.fu { color: #06287e; } /* Function */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code span.cn { color: #880000; } /* Constant */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.ss { color: #bb6688; } /* SpecialString */
code span.im { } /* Import */
code span.va { color: #19177c; } /* Variable */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.op { color: #666666; } /* Operator */
code span.bu { } /* BuiltIn */
code span.ex { } /* Extension */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.at { color: #7d9029; } /* Attribute */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Frequently asked questions for the sommer package</h1>
<h4 class="author"><em>Giovanny Covarrubias-Pazaran</em></h4>
<h4 class="date"><em>2019-04-17</em></h4>



<p>The sommer package was developed to provide R users a powerful and reliable multivariate mixed model solver. The package is focused in problems of the type p &gt; n (more effects to estimate than observations) and its core algorithm is coded in C++ using the Armadillo library. This package allows the user to fit mixed models with the advantage of specifying the variance-covariance structure for the random effects, and specify heterogeneous variances, and obtain other parameters such as BLUPs, BLUEs, residuals, fitted values, variances for fixed and random effects, etc.</p>
<p>The purpose of this vignette is to provide answers to frequently asked questions (FAQ) related to performance and possible issues:</p>
<div id="i-got-an-error-similar-to" class="section level3">
<h3>1) I got an error similar to:</h3>
<pre class="sourceCode r" id="cb1"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># iteration    LogLik     wall    cpu(sec)   restrained</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#     1      -224.676   18:11:23      3           0</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co"># Sistem is singular. Stopping the job</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># matrix multiplication: incompatible matrix dimensions: 0x0 and ...x...</span></a></code></pre>
<p>This error indicates that your model is singular (phenotypic variance V matrix is not invertible) and therefore the model is stopped throwing the “incompatible matrix dimensions: 0x0 and …x…” error message. Whether you can try a simpler model or just modify the argument <code>tolparinv</code> in the <code>mmer</code> function. The default is 1e-6, which means that it will try to invert V and if it fails it will try to add a small value to the diagonal of V of 1e-6 to make it invertible. If this fails then the program will stop returning that error message which should make you check the quality of your data or model attempted.</p>
<p>Sometimes the model becomes singular when you use variance covariance matrices (i.e. genomic relationship matrices) that are not full-rank. You can try to make it full-rank and try again.</p>
</div>
<div id="my-model-runs-very-slow" class="section level2">
<h2>2) My model runs very slow</h2>
<p>Keep in mind that sommer uses direct inversion (DI) algorithm which can be very slow for large datasets. The package is focused in problems of the type p &gt; n (more random effect levels than observations) and models with dense covariance structures. For example, for experiment with dense covariance structures with low-replication (i.e. 2000 records from 1000 individuals replicated twice with a covariance structure of 1000x1000) sommer will be faster than MME-based software. Also for genomic problems with large number of random effect levels, i.e. 300 individuals (n) with 100,000 genetic markers (p). For highly replicated trials with small covariance structures or n &gt; p (i.e. 2000 records from 200 individuals replicated 10 times with covariance structure of 200x200) asreml or other MME-based algorithms will be much faster and we recommend you to opt for those software.</p>
</div>
<div id="can-i-run-rrblup-for-markers-and-gblup-for-individuals-in-sommer" class="section level2">
<h2>3) Can I run rrBLUP for markers and GBLUP for individuals in sommer?</h2>
<p>Both types of models can be fitted in sommer. The only thing that it changes is what is the random effect of interest; the marker matrix or the identifier for the individual. Here there is a complex example using multi-trait models but can be used with only one trait.</p>
<pre class="sourceCode r" id="cb2"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(sommer)</a></code></pre>
<pre><code>## Warning: package 'sommer' was built under R version 3.5.2</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: crayon</code></pre>
<pre class="sourceCode r" id="cb8"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">## rrBLUP for makers</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">data</span>(DT_cpdata)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">mix.rrblup &lt;-<span class="st"> </span><span class="kw">mmer</span>(<span class="dt">fixed=</span>color<span class="op">~</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">                   <span class="dt">random=</span><span class="op">~</span><span class="kw">vs</span>(GT,<span class="dt">Gtc=</span><span class="kw">unsm</span>(<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">vs</span>(Rowf,<span class="dt">Gtc=</span><span class="kw">diag</span>(<span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">                   <span class="dt">rcov=</span><span class="op">~</span><span class="kw">vs</span>(units,<span class="dt">Gtc=</span><span class="kw">unsm</span>(<span class="dv">1</span>)), <span class="dt">getPEV =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">                   <span class="dt">data=</span>DT, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="kw">summary</span>(mix.rrblup)</a></code></pre>
<pre><code>## ============================================================
##          Multivariate Linear Mixed Model fit by REML         
## **********************  sommer 3.9  ********************** 
## ============================================================
##          logLik      AIC     BIC Method Converge
## Value -108.1202 218.2403 222.132     NR     TRUE
## ============================================================
## Variance-Covariance components:
##                       VarComp VarCompSE Zratio Constraint
## u:GT.color-color    4.213e-06 8.581e-07  4.909   Positive
## u:Rowf.color-color  1.963e-04 1.355e-04  1.449   Positive
## u:units.color-color 2.612e-03 2.926e-04  8.928   Positive
## ============================================================
## Fixed effects:
##   Trait      Effect Estimate Std.Error t.value
## 1 color (Intercept)   0.1692   0.03908   4.329
## ============================================================
## Groups and observations:
##        color
## u:GT    2889
## u:Rowf    13
## ============================================================
## Use the '$' sign to access results and parameters</code></pre>
<pre class="sourceCode r" id="cb10"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">## GBLUP for individuals</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">A &lt;-<span class="st"> </span><span class="kw">A.mat</span>(GT)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">mix.gblup &lt;-<span class="st"> </span><span class="kw">mmer</span>(<span class="dt">fixed=</span>color<span class="op">~</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">                  <span class="dt">random=</span><span class="op">~</span><span class="kw">vs</span>(id,<span class="dt">Gu=</span>A, <span class="dt">Gtc=</span><span class="kw">unsm</span>(<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">vs</span>(Rowf,<span class="dt">Gtc=</span><span class="kw">diag</span>(<span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">                  <span class="dt">rcov=</span><span class="op">~</span><span class="kw">vs</span>(units,<span class="dt">Gtc=</span><span class="kw">unsm</span>(<span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">                  <span class="dt">data=</span>DT, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="kw">summary</span>(mix.gblup)</a></code></pre>
<pre><code>## ============================================================
##          Multivariate Linear Mixed Model fit by REML         
## **********************  sommer 3.9  ********************** 
## ============================================================
##          logLik      AIC      BIC Method Converge
## Value -108.1201 218.2403 222.1319     NR     TRUE
## ============================================================
## Variance-Covariance components:
##                       VarComp VarCompSE Zratio Constraint
## u:id.color-color    0.0049524 0.0010082  4.912   Positive
## u:Rowf.color-color  0.0001965 0.0001359  1.446   Positive
## u:units.color-color 0.0026123 0.0002926  8.928   Positive
## ============================================================
## Fixed effects:
##   Trait      Effect Estimate Std.Error t.value
## 1 color (Intercept)   0.1831  0.004732    38.7
## ============================================================
## Groups and observations:
##        color
## u:id     363
## u:Rowf    13
## ============================================================
## Use the '$' sign to access results and parameters</code></pre>
<pre class="sourceCode r" id="cb12"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">## Equivalence</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">plot</span>(GT<span class="op">%*%</span>mix.rrblup<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:GT</span><span class="st">`</span><span class="op">$</span>color, mix.gblup<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:id</span><span class="st">`</span><span class="op">$</span>color)</a></code></pre>
<p><img src="data:image/png;base64,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0ieJGt5L5gv//PPPV5X76U9/6uecc04vzqhV59p1QJZgZHL1kh7ar7baav5b3/qWn2uuufzvfvc7bVLcRfw+++yjfZYZULu6YfUaAoZACxDInAH99re/jbRLSZZJlERkQ6+99lryVNv2WVYRLuTCCy90ZObAE580QS+//LK2SahYzrEEI4yskSFgCJQXgUwh9F133eVklqH+YIssskjFSC6//HK3++67u3/84x+u6LjQ//73v5URvf766+6///2v+9rXvlbRV9sxBAyB8iGQyYD++c9/usGDB7sllljCHXvssZqSmWOPPPKIJipcZ511VO1dvqG1t0dnn322u+CCC9yXvvSl9jZktRsCNRCQFZB+bPklTXoyVTqhk3/zm99oFuMaVRR+OJMB0UPCcJARlQSFcdpuu+1U0zTvvPPGD/eLbZE/uZNOOskYUL+42+UbJPZwhx12mK4+EEGglMFr4ZprrtFUWfR46NCh7qGHHnIrrbRS+QbwSY9yqeFZejHgP/7xj5qah1xgqN8HDRpU2oG1u2PcdMwQME0wMgQ6iQDyzr333luNbLGHI2IFMs/bbrvNHXrooe6+++5TcQReAWWnTCF0fADIVTbffHOHkd+AAQPipzq2TZZW0bzl+kNIbmQI9BIC+DmSpZjZDsoY3sOBAweq6xG2eaKtdlOnTu2aIdecAbHsIvGgqNqdqLl1QASqxx6IAGXMgnbYYQd33nnnuU4uwYhXve222yrXP/roo6vWvXHku+ELEO+vbRsCtRBAyQJhi4fMB5/IJJ122mluwoQJuuzaYostkqdLuZ/KgMSmxuHiAJd97733lAH99a9/1Rcfjovw9fe//73DD2vkyJHuV7/6VccGt9566+kUEx8vvgajR49uadssNRHcZRFhSp599lk1Bcgqa+cNgUYRmDRpkvo6vvrqq/qxXW655XR59f7771dVycqAd6JojXRVx/o4kMqAfvGLX7gNNtjATZs2TZ1Puf66665zMCHU8iQlhGBSWCK/8847mr5ZD3bgHzObE0880Y0dO1YZIKmjW0V8abC0ziJMD95+++2sYnbeEGgYAVYX+++/v76Lu+66q37wWXZBOGBjAkOm4kCXXXaZasU22WSTcKj8v0ljRvFu98JBvch7vEjPoz9xa/Ci1ov2wzkZoReG4I844ohkVW3dF0bh77jjDv+Xv/ylre3U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" /><!-- --></p>
</div>
<div id="i-am-missing-blups-for-individuals-even-when-i-provided-them-in-the-relationship-matrix" class="section level2">
<h2>4) I am missing BLUPs for individuals even when I provided them in the relationship matrix</h2>
<p>I got this good question in the past: “when I want to fit an animal model with sommer package using additive relationship matrix(A), this A matrix would contain parents. But the random effects only contains animals in the random effect but not including parents in the A matrix. How can I get the random effects for parents?”&quot;</p>
<p>Answer: The easy way to do it is to make sure that even if the parents don’t show up in the dataset, you need to make sure that they are present in the levels of the column that contains the animals, in addition they have to be provided in the relationship matrix and that’s it. They should be returned in the blups.</p>
<pre class="sourceCode r" id="cb13"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">library</span>(sommer)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw">data</span>(DT_cpdata)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">#### create the variance-covariance matrix</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">A &lt;-<span class="st"> </span><span class="kw">A.mat</span>(GT) <span class="co"># additive relationship matrix</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6">#### look at the data and fit the model</a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="kw">set.seed</span>(<span class="dv">12</span>)</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">DT2 &lt;-<span class="st"> </span><span class="kw">droplevels</span>(DT[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(DT),<span class="dv">100</span>),]) <span class="co"># we simulate a dataset with only 100 animals</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="kw">nrow</span>(DT2); <span class="kw">length</span>(<span class="kw">levels</span>(DT2<span class="op">$</span>id))</a></code></pre>
<pre><code>## [1] 100</code></pre>
<pre><code>## [1] 100</code></pre>
<pre class="sourceCode r" id="cb16"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># we fit a model with the reduced datatset where only 100 blups will be returned since only</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co"># 100 levels exist in the &quot;id&quot; column</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3">mix1 &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield<span class="op">~</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">              <span class="dt">random=</span><span class="op">~</span><span class="kw">vs</span>(id,<span class="dt">Gu=</span>A)</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">                      <span class="op">+</span><span class="st"> </span>Rowf <span class="op">+</span><span class="st"> </span>Colf,</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">              <span class="dt">rcov=</span><span class="op">~</span>units,</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">              <span class="dt">data=</span>DT2, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="kw">summary</span>(mix1)</a></code></pre>
<pre><code>## ============================================================
##          Multivariate Linear Mixed Model fit by REML         
## **********************  sommer 3.9  ********************** 
## ============================================================
##          logLik      AIC      BIC Method Converge
## Value -45.86523 93.73045 96.32557     NR     TRUE
## ============================================================
## Variance-Covariance components:
##                   VarComp VarCompSE Zratio Constraint
## u:id.Yield-Yield  1655.45     990.7 1.6710   Positive
## Rowf.Yield-Yield   747.25     529.5 1.4111   Positive
## Colf.Yield-Yield    46.52     379.4 0.1226   Positive
## units.Yield-Yield 2811.86     786.3 3.5759   Positive
## ============================================================
## Fixed effects:
##   Trait      Effect Estimate Std.Error t.value
## 1 Yield (Intercept)    133.7     9.908   13.49
## ============================================================
## Groups and observations:
##      Yield
## u:id   100
## Rowf    13
## Colf    34
## ============================================================
## Use the '$' sign to access results and parameters</code></pre>
<pre class="sourceCode r" id="cb18"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">length</span>(mix1<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:id</span><span class="st">`</span><span class="op">$</span>Yield) <span class="co"># only 100 levels</span></a></code></pre>
<pre><code>## [1] 100</code></pre>
<pre class="sourceCode r" id="cb20"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co"># we add additional levels to the &quot;id&quot; column and also provide them in the relationship matrix</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="kw">levels</span>(DT2<span class="op">$</span>id) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">levels</span>(DT2<span class="op">$</span>id), <span class="kw">setdiff</span>(<span class="kw">levels</span>(DT<span class="op">$</span>id), <span class="kw">levels</span>(DT2<span class="op">$</span>id)))</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">mix2 &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield<span class="op">~</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">             <span class="dt">random=</span><span class="op">~</span><span class="kw">vs</span>(id,<span class="dt">Gu=</span>A)</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">             <span class="op">+</span><span class="st"> </span>Rowf <span class="op">+</span><span class="st"> </span>Colf,</a>
<a class="sourceLine" id="cb20-6" data-line-number="6">             <span class="dt">rcov=</span><span class="op">~</span>units,</a>
<a class="sourceLine" id="cb20-7" data-line-number="7">             <span class="dt">data=</span>DT2, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="kw">summary</span>(mix2)</a></code></pre>
<pre><code>## ============================================================
##          Multivariate Linear Mixed Model fit by REML         
## **********************  sommer 3.9  ********************** 
## ============================================================
##          logLik      AIC      BIC Method Converge
## Value -45.86523 93.73045 96.32557     NR     TRUE
## ============================================================
## Variance-Covariance components:
##                   VarComp VarCompSE Zratio Constraint
## u:id.Yield-Yield  1655.45     990.7 1.6710   Positive
## Rowf.Yield-Yield   747.25     529.5 1.4111   Positive
## Colf.Yield-Yield    46.52     379.4 0.1226   Positive
## units.Yield-Yield 2811.86     786.3 3.5759   Positive
## ============================================================
## Fixed effects:
##   Trait      Effect Estimate Std.Error t.value
## 1 Yield (Intercept)    133.7     9.908   13.49
## ============================================================
## Groups and observations:
##      Yield
## u:id   363
## Rowf    13
## Colf    34
## ============================================================
## Use the '$' sign to access results and parameters</code></pre>
<pre class="sourceCode r" id="cb22"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">length</span>(mix2<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:id</span><span class="st">`</span><span class="op">$</span>Yield) <span class="co"># now 363 levels</span></a></code></pre>
<pre><code>## [1] 363</code></pre>
</div>
<div id="how-can-i-use-the-ar1-cs-and-arma-functions" class="section level2">
<h2>5) How can I use the AR1(), CS() and ARMA() functions</h2>
<p>Sommer doesn’t support the estimation of additional correlation components like AR1 in the way asreml does. Still, if the user know the correlation value or can do an iterative approach to find the best value then these functions can be used to specify the variance covariance structure for a given random effect.</p>
<p>For example, in the DT_cpdata dataset we have a field with row and column coordinates. This allows to fit row and column as random effects:</p>
<pre class="sourceCode r" id="cb24"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">library</span>(sommer)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="kw">data</span>(DT_cpdata)</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">mix1 &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield<span class="op">~</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb24-4" data-line-number="4">              <span class="dt">random=</span><span class="op">~</span><span class="st"> </span>Rowf <span class="op">+</span><span class="st"> </span>Colf,</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">              <span class="dt">rcov=</span><span class="op">~</span>units,</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">              <span class="dt">data=</span>DT, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="kw">summary</span>(mix1)<span class="op">$</span>varcomp</a></code></pre>
<pre><code>##                     VarComp VarCompSE    Zratio Constraint
## Rowf.Yield-Yield   832.2879  393.8951  2.112968   Positive
## Colf.Yield-Yield   153.9201  126.7582  1.214281   Positive
## units.Yield-Yield 3647.3486  290.4910 12.555804   Positive</code></pre>
<p>If the user wants to relax the independence between rows and define an AR1 covariance structure among rows then the model could be fitted as:</p>
<pre class="sourceCode r" id="cb26"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">library</span>(sommer)</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="kw">data</span>(DT_cpdata)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">mixAR1row &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield<span class="op">~</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">             <span class="dt">random=</span><span class="op">~</span><span class="st"> </span><span class="kw">vs</span>(Rowf, <span class="dt">Gu=</span><span class="kw">AR1</span>(Rowf, <span class="dt">rho=</span><span class="fl">0.3</span>)) <span class="op">+</span><span class="st"> </span>Colf,</a>
<a class="sourceLine" id="cb26-5" data-line-number="5">             <span class="dt">rcov=</span><span class="op">~</span>units,</a>
<a class="sourceLine" id="cb26-6" data-line-number="6">             <span class="dt">data=</span>DT, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb26-7" data-line-number="7"><span class="kw">summary</span>(mixAR1row)<span class="op">$</span>varcomp</a></code></pre>
<pre><code>##                      VarComp VarCompSE    Zratio Constraint
## u:Rowf.Yield-Yield  791.8219  387.8695  2.041465   Positive
## Colf.Yield-Yield    154.5660  126.8094  1.218885   Positive
## units.Yield-Yield  3643.6027  290.1689 12.556834   Positive</code></pre>
<p>Same could be done for the column random effect:</p>
<pre class="sourceCode r" id="cb28"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">library</span>(sommer)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="kw">data</span>(DT_cpdata)</a>
<a class="sourceLine" id="cb28-3" data-line-number="3">mixAR1col &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield<span class="op">~</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb28-4" data-line-number="4">             <span class="dt">random=</span><span class="op">~</span><span class="st"> </span>Rowf <span class="op">+</span><span class="st"> </span><span class="kw">vs</span>(Colf, <span class="dt">Gu=</span><span class="kw">AR1</span>(Colf, <span class="dt">rho=</span><span class="fl">0.3</span>)),</a>
<a class="sourceLine" id="cb28-5" data-line-number="5">             <span class="dt">rcov=</span><span class="op">~</span>units,</a>
<a class="sourceLine" id="cb28-6" data-line-number="6">             <span class="dt">data=</span>DT, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="kw">summary</span>(mixAR1col)<span class="op">$</span>varcomp</a></code></pre>
<pre><code>##                      VarComp VarCompSE    Zratio Constraint
## Rowf.Yield-Yield    830.3623  392.8264  2.113815   Positive
## u:Colf.Yield-Yield  178.7490  134.2703  1.331262   Positive
## units.Yield-Yield  3624.6074  287.6072 12.602629   Positive</code></pre>
<p>If on the other hand, you would like to stablish the presence of correlation in row and columns at the same time the model would look like this:</p>
<pre class="sourceCode r" id="cb30"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">library</span>(sommer)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw">data</span>(DT_cpdata)</a>
<a class="sourceLine" id="cb30-3" data-line-number="3">mixAR1rowcol &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield<span class="op">~</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb30-4" data-line-number="4">                  <span class="dt">random=</span><span class="op">~</span><span class="st"> </span><span class="kw">vs</span>(Rowf<span class="op">:</span>Colf, </a>
<a class="sourceLine" id="cb30-5" data-line-number="5">                              <span class="dt">Gu=</span><span class="kw">kronecker</span>(<span class="kw">AR1</span>(Rowf, <span class="dt">rho=</span><span class="fl">0.3</span>),<span class="kw">AR1</span>(Colf, <span class="dt">rho=</span><span class="fl">0.3</span>),<span class="dt">make.dimnames =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb30-6" data-line-number="6">                              ),</a>
<a class="sourceLine" id="cb30-7" data-line-number="7">                  <span class="dt">rcov=</span><span class="op">~</span>units,</a>
<a class="sourceLine" id="cb30-8" data-line-number="8">                  <span class="dt">data=</span>DT, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb30-9" data-line-number="9"><span class="kw">summary</span>(mixAR1rowcol)<span class="op">$</span>varcomp</a></code></pre>
<pre><code>##                          VarComp VarCompSE   Zratio Constraint
## u:Rowf:Colf.Yield-Yield 2474.339  730.1474 3.388821   Positive
## units.Yield-Yield       2025.584  622.1023 3.256030   Positive</code></pre>
<p>Notice that if you specify a random effect that is the interaction between 2 random effects the covariance structure to be specified in the <code>Gu</code> argument has to be built using the <code>kronecker()</code> function. The same applies to the <code>ARMA()</code> and <code>CS()</code> functions. Please keep in mind that the correlation values (rho argument) is a fixed value not estimated by REML like asreml does but you can always follow an iterative approach.</p>
</div>
<div id="literature" class="section level2">
<h2>Literature</h2>
<p>Covarrubias-Pazaran G. 2016. Genome assisted prediction of quantitative traits using the R package sommer. PLoS ONE 11(6):1-15.</p>
<p>Covarrubias-Pazaran G. 2018. Software update: Moving the R package sommer to multivariate mixed models for genome-assisted prediction. doi: <a href="https://doi.org/10.1101/354639" class="uri">https://doi.org/10.1101/354639</a></p>
<p>Bernardo Rex. 2010. Breeding for quantitative traits in plants. Second edition. Stemma Press. 390 pp.</p>
<p>Gilmour et al. 1995. Average Information REML: An efficient algorithm for variance parameter estimation in linear mixed models. Biometrics 51(4):1440-1450.</p>
<p>Henderson C.R. 1975. Best Linear Unbiased Estimation and Prediction under a Selection Model. Biometrics vol. 31(2):423-447.</p>
<p>Kang et al. 2008. Efficient control of population structure in model organism association mapping. Genetics 178:1709-1723.</p>
<p>Lee, D.-J., Durban, M., and Eilers, P.H.C. (2013). Efficient two-dimensional smoothing with P-spline ANOVA mixed models and nested bases. Computational Statistics and Data Analysis, 61, 22 - 37.</p>
<p>Lee et al. 2015. MTG2: An efficient algorithm for multivariate linear mixed model analysis based on genomic information. Cold Spring Harbor. doi: <a href="http://dx.doi.org/10.1101/027201" class="uri">http://dx.doi.org/10.1101/027201</a>.</p>
<p>Maier et al. 2015. Joint analysis of psychiatric disorders increases accuracy of risk prediction for schizophrenia, bipolar disorder, and major depressive disorder. Am J Hum Genet; 96(2):283-294.</p>
<p>Rodriguez-Alvarez, Maria Xose, et al. Correcting for spatial heterogeneity in plant breeding experiments with P-splines. Spatial Statistics 23 (2018): 52-71.</p>
<p>Searle. 1993. Applying the EM algorithm to calculating ML and REML estimates of variance components. Paper invited for the 1993 American Statistical Association Meeting, San Francisco.</p>
<p>Yu et al. 2006. A unified mixed-model method for association mapping that accounts for multiple levels of relatedness. Genetics 38:203-208.</p>
<p>Abdollahi Arpanahi R, Morota G, Valente BD, Kranis A, Rosa GJM, Gianola D. 2015. Assessment of bagging GBLUP for whole genome prediction of broiler chicken traits. Journal of Animal Breeding and Genetics 132:218-228.</p>
<p>Tunnicliffe W. 1989. On the use of marginal likelihood in time series model estimation. JRSS 51(1):15-27.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
