<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Giovanny Covarrubias-Pazaran" />

<meta name="date" content="2021-10-07" />

<title>Spatial modeling using the sommer package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Spatial modeling using the sommer package</h1>
<h4 class="author">Giovanny Covarrubias-Pazaran</h4>
<h4 class="date">2021-10-07</h4>



<p>The sommer package was developed to provide R users with a powerful and reliable multivariate mixed model solver for different genetic (in diploid and polyploid organisms) and non-genetic analyses. This package allows the user to estimate variance components in a mixed model with the advantages of specifying the variance-covariance structure of the random effects, specifying heterogeneous variances, and obtaining other parameters such as BLUPs, BLUEs, residuals, fitted values, variances for fixed and random effects, etc. The core algorithms of the package are coded in C++ using the Armadillo library to optimize dense matrix operations common in the derect-inversion algorithms.</p>
<p>This vignette is focused on showing the capabilities of sommer to fit spatial models using the two dimensional splines models.</p>
<p><strong>SECTION 1: Introduction </strong></p>
<ol style="list-style-type: decimal">
<li>Background in tensor products</li>
</ol>
<p><strong>SECTION 2: Spatial models</strong></p>
<ol style="list-style-type: decimal">
<li>Two dimensional splines (multiple spatial components)</li>
<li>Two dimensional splines (single spatial component)</li>
<li>Spatial models in multiple trials at once</li>
</ol>
<div id="section-1-introduction" class="section level2">
<h2>SECTION 1: Introduction</h2>
<div id="backgrounds-in-tensor-products" class="section level3">
<h3>Backgrounds in tensor products</h3>
<p>TBD</p>
</div>
</div>
<div id="section-2-spatial-models" class="section level2">
<h2>SECTION 2: Spatial models</h2>
<div id="two-dimensional-splines-multiple-spatial-components" class="section level3">
<h3>1) Two dimensional splines (multiple spatial components)</h3>
<p>In this example we show how to obtain the same results than using the SpATS package. This is achieved by using the <code>spl2Db</code> function which is a wrapper of the <code>tpsmmb</code> function.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(sommer)</span></code></pre></div>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: crayon</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">data</span>(DT_yatesoats)</span>
<span id="cb6-2"><a href="#cb6-2"></a>DT &lt;-<span class="st"> </span>DT_yatesoats</span>
<span id="cb6-3"><a href="#cb6-3"></a>DT<span class="op">$</span>row &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(DT<span class="op">$</span>row))</span>
<span id="cb6-4"><a href="#cb6-4"></a>DT<span class="op">$</span>col &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(DT<span class="op">$</span>col))</span>
<span id="cb6-5"><a href="#cb6-5"></a>DT<span class="op">$</span>R &lt;-<span class="st"> </span><span class="kw">as.factor</span>(DT<span class="op">$</span>row)</span>
<span id="cb6-6"><a href="#cb6-6"></a>DT<span class="op">$</span>C &lt;-<span class="st"> </span><span class="kw">as.factor</span>(DT<span class="op">$</span>col)</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co"># SPATS MODEL</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co"># m1.SpATS &lt;- SpATS(response = &quot;Y&quot;,</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#                   spatial = ~ PSANOVA(col, row, nseg = c(14,21), degree = 3, pord = 2),</span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#                   genotype = &quot;V&quot;, fixed = ~ 1,</span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">#                   random = ~ R + C, data = DT,</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">#                   control = list(tolerance = 1e-04))</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co"># </span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co"># summary(m1.SpATS, which = &quot;variances&quot;)</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co"># </span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co"># Spatial analysis of trials with splines </span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co"># </span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co"># Response:                   Y         </span></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co"># Genotypes (as fixed):       V         </span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co"># Spatial:                    ~PSANOVA(col, row, nseg = c(14, 21), degree = 3, pord = 2)</span></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="co"># Fixed:                      ~1        </span></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="co"># Random:                     ~R + C    </span></span>
<span id="cb6-24"><a href="#cb6-24"></a><span class="co"># </span></span>
<span id="cb6-25"><a href="#cb6-25"></a><span class="co"># </span></span>
<span id="cb6-26"><a href="#cb6-26"></a><span class="co"># Number of observations:        72</span></span>
<span id="cb6-27"><a href="#cb6-27"></a><span class="co"># Number of missing data:        0</span></span>
<span id="cb6-28"><a href="#cb6-28"></a><span class="co"># Effective dimension:           17.09</span></span>
<span id="cb6-29"><a href="#cb6-29"></a><span class="co"># Deviance:                      483.405</span></span>
<span id="cb6-30"><a href="#cb6-30"></a><span class="co"># </span></span>
<span id="cb6-31"><a href="#cb6-31"></a><span class="co"># Variance components:</span></span>
<span id="cb6-32"><a href="#cb6-32"></a><span class="co">#                   Variance            SD     log10(lambda)</span></span>
<span id="cb6-33"><a href="#cb6-33"></a><span class="co"># R                 1.277e+02     1.130e+01           0.49450</span></span>
<span id="cb6-34"><a href="#cb6-34"></a><span class="co"># C                 2.673e-05     5.170e-03           7.17366</span></span>
<span id="cb6-35"><a href="#cb6-35"></a><span class="co"># f(col)            4.018e-15     6.339e-08          16.99668</span></span>
<span id="cb6-36"><a href="#cb6-36"></a><span class="co"># f(row)            2.291e-10     1.514e-05          12.24059</span></span>
<span id="cb6-37"><a href="#cb6-37"></a><span class="co"># f(col):row        1.025e-04     1.012e-02           6.59013</span></span>
<span id="cb6-38"><a href="#cb6-38"></a><span class="co"># col:f(row)        8.789e+01     9.375e+00           0.65674</span></span>
<span id="cb6-39"><a href="#cb6-39"></a><span class="co"># f(col):f(row)     8.036e-04     2.835e-02           5.69565</span></span>
<span id="cb6-40"><a href="#cb6-40"></a><span class="co"># </span></span>
<span id="cb6-41"><a href="#cb6-41"></a><span class="co"># Residual          3.987e+02     1.997e+01 </span></span>
<span id="cb6-42"><a href="#cb6-42"></a></span>
<span id="cb6-43"><a href="#cb6-43"></a><span class="co"># SOMMER MODEL</span></span>
<span id="cb6-44"><a href="#cb6-44"></a>m1.sommer &lt;-<span class="st"> </span><span class="kw">mmer</span>(Y<span class="op">~</span><span class="dv">1</span><span class="op">+</span>V<span class="op">+</span><span class="kw">spl2Db</span>(col,row, <span class="dt">nsegments =</span> <span class="kw">c</span>(<span class="dv">14</span>,<span class="dv">21</span>), <span class="dt">degree =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">penaltyord =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">what =</span> <span class="st">&quot;base&quot;</span>), </span>
<span id="cb6-45"><a href="#cb6-45"></a>                  <span class="dt">random =</span> <span class="op">~</span>R<span class="op">+</span>C<span class="op">+</span><span class="kw">spl2Db</span>(col,row, <span class="dt">nsegments =</span> <span class="kw">c</span>(<span class="dv">14</span>,<span class="dv">21</span>), <span class="dt">degree =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">penaltyord =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">what=</span><span class="st">&quot;bits&quot;</span>),</span>
<span id="cb6-46"><a href="#cb6-46"></a>                  <span class="dt">data=</span>DT, <span class="dt">tolpar =</span> <span class="fl">1e-6</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## fixed-effect model matrix is rank deficient so dropping 8 columns / coefficients</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">summary</span>(m1.sommer)<span class="op">$</span>varcomp</span></code></pre></div>
<pre><code>##                VarComp VarCompSE     Zratio Constraint
## R.Y-Y       125.928235  89.77330  1.4027360   Positive
## C.Y-Y        -7.789528  24.29529 -0.3206189   Positive
## A:fC.Y-Y      0.000000  19.09624  0.0000000   Positive
## A:fR.Y-Y      0.000000  15.87659  0.0000000   Positive
## A:fC.R.Y-Y    0.000000  21.42763  0.0000000   Positive
## A:C.fR.Y-Y   82.177296  92.28630  0.8904604   Positive
## A:fC.fR.Y-Y   0.000000  25.46390  0.0000000   Positive
## units.Y-Y   405.900386  90.48195  4.4859820   Positive</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># get the fitted values for the spatial kernel and plot</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>ff &lt;-<span class="st"> </span><span class="kw">fitted.mmer</span>(m1.sommer)</span></code></pre></div>
<pre><code>## fixed-effect model matrix is rank deficient so dropping 8 columns / coefficients
## fixed-effect model matrix is rank deficient so dropping 8 columns / coefficients</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>DT<span class="op">$</span>fit &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">Reduce</span>(<span class="st">&quot;+&quot;</span>,ff<span class="op">$</span>Zu[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)])) </span>
<span id="cb12-2"><a href="#cb12-2"></a>lattice<span class="op">::</span><span class="kw">levelplot</span>(fit<span class="op">~</span>row<span class="op">*</span>col,<span class="dt">data=</span>DT)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="two-dimensional-splines-single-spatial-component" class="section level3">
<h3>2) Two dimensional splines (single spatial component)</h3>
<p>To reduce the computational burden of fitting multiple spatial kernels <code>sommer</code> provides a single spatial kernel method through the <code>spl2Da</code> function. This as will be shown, can produce similar results to the more flexible model. Use the one that fits better your needs.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># SOMMER MODEL</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>m2.sommer &lt;-<span class="st"> </span><span class="kw">mmer</span>(Y<span class="op">~</span><span class="dv">1</span><span class="op">+</span>V, </span>
<span id="cb13-3"><a href="#cb13-3"></a>                  <span class="dt">random =</span> <span class="op">~</span>R<span class="op">+</span>C<span class="op">+</span><span class="kw">spl2Da</span>(col,row, <span class="dt">nsegments =</span> <span class="kw">c</span>(<span class="dv">14</span>,<span class="dv">21</span>), <span class="dt">degree =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">penaltyord =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb13-4"><a href="#cb13-4"></a>                  <span class="dt">data=</span>DT, <span class="dt">tolpar =</span> <span class="fl">1e-6</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="kw">summary</span>(m1.sommer)<span class="op">$</span>varcomp</span></code></pre></div>
<pre><code>##                VarComp VarCompSE     Zratio Constraint
## R.Y-Y       125.928235  89.77330  1.4027360   Positive
## C.Y-Y        -7.789528  24.29529 -0.3206189   Positive
## A:fC.Y-Y      0.000000  19.09624  0.0000000   Positive
## A:fR.Y-Y      0.000000  15.87659  0.0000000   Positive
## A:fC.R.Y-Y    0.000000  21.42763  0.0000000   Positive
## A:C.fR.Y-Y   82.177296  92.28630  0.8904604   Positive
## A:fC.fR.Y-Y   0.000000  25.46390  0.0000000   Positive
## units.Y-Y   405.900386  90.48195  4.4859820   Positive</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># get the fitted values for the spatial kernel and plot</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>ff &lt;-<span class="st"> </span><span class="kw">fitted.mmer</span>(m2.sommer)</span>
<span id="cb15-3"><a href="#cb15-3"></a>DT<span class="op">$</span>fit &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">Reduce</span>(<span class="st">&quot;+&quot;</span>,ff<span class="op">$</span>Zu[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)])) </span>
<span id="cb15-4"><a href="#cb15-4"></a>lattice<span class="op">::</span><span class="kw">levelplot</span>(fit<span class="op">~</span>row<span class="op">*</span>col,<span class="dt">data=</span>DT)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAYAAAAUg66AAAAEGWlDQ1BrQ0dDb2xvclNwYWNlR2VuZXJpY1JHQgAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VQNcC+8AACFrSURBVHgB7Z0LcBXV/cd/IYQACRAgkfAOiQUKBHmTAPLSsVawWCmDQEkRWrVFhDikSvnjINSBQWixlY6ADFOYKKIIVBBTOwgYICopiRAe4RE1vCE8Agnv3P/9nXa39+be3fvae/fcu9/jXHf3vM/nbL6cPXv2/KJsdkdwIAACIGACgTomlIkiQQAEQEAQgADhRgABEDCNAATINPQoGARAAAKEewAEQMA0AhAg09CjYBAAAQgQ7gEQAAHTCECATEOPgkEABCBAuAdAAARMIwABMg09CgYBEIAA4R4AARAwjQAEyDT0KBgEQAAChHsABEDANAIQINPQo2AQAAEIEO4BEAAB0whAgExDj4JBAAQgQLgHQAAETCMAATINPQoGARCAAOEeAAEQMI0ABMg09CgYBEAAAoR7AARAwDQCECDT0KNgEAABCBDuARAAAdMIQIBMQ4+CQQAEIEC4B0AABEwjAAEyDT0KBgEQgADhHgABEDCNAATINPQoGARAAAKEewAEQMA0AhAg09CjYBAAAQgQ7gEQAAHTCECATEOPgkEABCBAuAdAAARMIwABMg09CgYBEIAA4R4AARAwjQAEyDT0KBgEQAAChHsABEDANAIQINPQo2AQAAEIUAjvgaKiIuKfjO7DDz+kqqoq6ap29uxZysvLk65eqJAxBCBAxnD0KpfNmzfTpk2bvIob6kgzZ86kioqKUBfrsbySkhJavHixx3iIEJ4EIEDh2W+oNQhEBAEIUER0IxoBAuFJAAIUnv2GWoNARBCAAEVEN6IRIBCeBCBA4dlvqDUIRAQBCFBEdCMaAQLhSSDKZnfhWXXvan3p0iXKzMyk+vXre5cgiLEuXLhAjLtFixZBLMW/rI8ePUodOnSgevXq+ZdBkFLduHGDLl68KOoWpCLUbHkZQnZ2NuXk5Kh+oTrZu3cvDR8+nB588EHDizx27BgVFxdTp06dDM870AwjXoB27NhBL776Kk1duVKTVTPNkP8EpOiENzilE8hBHpbW2Ar100c9ph2+u412GIf00g/WDb2mG0qUXKwfwVamH37rKe3wBh7ypubaaUWIB+ZRGn/jZ86eobmL5hKLQajdjBkz6JvEREobNcrwog+uWkWjk5Jo9uzZhucdaIZ1A80gHNLXs49+OqSna1Y1STPkPwF6/27ExXtIfF4/3HZaPzyqs3b4mQ7aYRzSVT9YN/SybihRWw+Lpm139TOo1u4OivOQN3kaQHpgHqUB5lrlNYqOjtaveJBCo6KiKCYujpJ07lN/i+Z8ZXWYA5K1Z1AvELAAAQiQBToZTQQBWQlAgGTtGdQLBCQhcPz4cbp71/WZml+qXLvmabZQvxEQIH0+CAUBSxMoKCigbt26iTeRCgjeNeGRRx6h3r17U8uWLYkn0P19mQ4BUqjiCAIgoBJgQVm+fDmNHDmSbt++rfrzyZw5cyg5OZl4ZMS7FWzZsoW2bdvmFMfbCwiQt6QQDwQsRGD79u20YsUK+uSTT1xavWHDBpo2bRrFxsaK9VkTJkygdevWucTzxsMSr+G9AYE4IBCpBCq/+46+OH+eampqXJo4adIkatu2rYv/wIEDqbCw0GXuh+eCTp06RSkpKWqa9u3b05dffqle+3ICAfKFFuKCQBgS4Mep+/fvu4gJN8WdKLG/1pcDPPHMaRo3bszRhGvUqBFduXJFufTpCAHyCRcig0D4EWhi/8Tm0a5dDVkJ3bz5f5ahX79+nRo2bChgVFZWUqtWrfwCAwHyCxsSgYDxBBrYs2xqfLZk5FeQPDJKsn/WUVZWpn7TyOeOj2S+NAGT0L7QQlwQAAHKysqiRYsWEY98Dh8+TLm5uTR27Fi/yECA/MKGRCBgXQKzZs2iy5cvU2pqKg0bNoymTJlCgwcP9gsIHsH8woZEIGANAjExMS6LDHkeiHeZ4K1uEhISqG5d/2XE/5TW4I9WggAIaBBItG8fEqjDI1igBJEeBEDAbwJSC1B5eTlVV1f73TgkBAEQkJuAtALEs+u8haQZu9PJ3WWoHQhEDgEpBYiXe/OrPjgQAIHIJiDlJDR/bcuv97xd3s2rMu/du+e2pzjM360C3GYIz4gmwPeR3n0XHx9P/GYIzhgC0gnQrl27KC8vj3gfko8//tirVvKWAQcOHHAbl0dTrSS0BuC2svA0ncC+ffsoLS1Nsx5r1qwRW1RoRggggFdCJwSQXiupkSuhtcrw118qAeLd1X7961/TRx99JD7197ZRO3fu1IzK6xVenjtXMxwBIOBIICMjg/Lz8x29cB5EAlLNAU2fPp369etHvOMaTz7funWLDh06JD7/DyIDZA0CIGASAalGQGyE7uTJkzR16lSBgw3S/eUvfxHG8p5//nmTEKFYEACBYBGQSoD40cvRsZXId955R+w/6+iPcxAAgcggINUjWGQgRStAAAS8JSDVCKh2pXnTazgQAIHIJYARUOT2LVoGAtITgABJ30WoIAhELgEIUOT2LVoGAtITgABJ30WoIAhELgGpJ6EjFztaBgKuBOLsXoFv8eWaL3/iIavDCEjWnkG9QMACBCBAFuhkNBEEZCUAAZK1Z1AvELAAAQiQBToZTQQBWQlAgGTtGdQLBCxAAAJkgU5GE0FAVgIQIFl7BvUCAQsQgABZoJPRRBCQlQAESNaeQb1AwAIEIEAW6GQ0EQRkJWCJTzF4ifsgnR6Iv64TaA+yXdIOr+qgHcYhRz2EX8zQT68XmqQXaA+LK9OPUK5Tt3YemNzwUO/LHsJ18++qX+8a540zXSLbDrt4OXlo/atr88DLKZMgXMhmFePmzZtOrWRzRHXrGisZWn3hVDAuQAAErEWgtLSUGjZs6PSbN2+e4RCMlTPDq4cMQQAEzCBQVFREgwYNon/+859q8cEwyAgBUvHiBARAQCHAAtSnTx9q0KABsXHPYIgPlwUBUojjCAIRSuDE/v1UYLevxxaHa7u3336bunfvXtub9tvTVFZWUseOHen777+n0aNH0/Lly6lRo0YucQPxgAAFQg9pQSAMCCSnplKP1q0pKyvLpbYpKSkufuyRmJhIw4cPp5deeolKSkpo4sSJNGvWLGLBMtJBgIykibxAQEICcU2aUIp9Qvnhhx/2unZr165V4/bq1YvYMOjSpUtVP6NO8BbMKJLIBwQihADP+SxZsoQuXfrf+pOoqChKtY+kjHYQIKOJIj8QCHMCPOG8c+dOWrBgAdlsNjp79iytWrWKxo4da3jLIECGI0WGIBD+BBYuXEhHjhyhtLQ0YhPpffv2dTuHFGhLMQcUKEGkB4EIJNClSxfaunUrXbt2jWJjY6l+/fpBaSUEKChYkSkI+E4g3p7E0+c1vudK1NCfRP9N08Q+gR1Mh0ewYNJF3iAAAroEIEC6eBAIAiAQTAIQoGDSRd4gAAK6BCBAungQCAIgEEwCEKBg0kXeIAACugSkFCBe/FRWVkY1NTW6lUcgCIBAeBOQToByc3PF4qdRo0ZRcnIybd++PbwJo/YgAAKaBKRaB8SLnqZPny42QeIP4FiM+AveU6dOaTYAASAAAuFLQKoRED96rVu3jlh82LW2byFw5coVunPnTvgSRs1BAAQ0CUg1AkpISKBHH32UqqqqaOXKlbRixQp6/fXXqV69epoN4IDFixfT6dOn3cYpLy+nO7dvuw2DJwjUJnDy5EnKzs6u7a1eT548mdLT09VrnARGQCoBUppy8eJFOnz4sBCi8+fPixGQngi1atVKc7d+3lrg1JkzStY4goAuAf7mqX379ppxeIvSYDkZP8UIVluVfKUUIN6ljbd/rK6uJhaXoUOH0ogRI5Q6uxzHjx/v4qd47Nixg4oPHlQucQQBXQJ8v82YMUM3DgKNIyDVHNAh+761jls+slmQbt260bfffmtci5ETCICANASkEqCWLVvS7Nmz6auvvhKAvvzySyooKBB700pDDBUBARAwjIBUj2BNmzald955h5577jm6fv06VVRUiOv+/fsb1mBkBAIgIA8BqQSIsYwbN078eBvIBx54gKKjo+WhhZqAAAgYSkA6AVJax49jcCAAApFNQKo5oMhGjdaBAAjUJgABqk0E1yAAAiEjAAEKGWoUBAIgUJsABKg2EVyDAAiEjIC0k9AhI4CCQEASAmy9olkQ6hK8j0cCryxGQIEzRA4gAAJ+EtAdAfFiwNWrV3ud9RNPPCGsKHqdABFBAAQsTUBXgK5evUo5OTleA+L9e9iMKxwIgAAIeENAV4Datm1Lt93spcM7F7LdaN5ArHv37sQfjcKBAAiAgK8EfJoD4r11fv/731NiYiJlZGRQZmYmNWrUiAYMGEC8bw8cCIAACPhCwCcB4t0Jly1bRrz/zocffkj79+8X+zbzDobDhg1zO1rypTKICwIgIBeBCxcuED/xBMvpPoI5FsqPW2+99RbNnDlTbJOqhPXo0YP69u1LHTt2FFtnDBkyRAnCEQRAIEwJ8KDiZz/7GZWWlopdKXiHij//+c8UFRVlaIu8HgGdsW9reuPGDZo0aZJLBdLS0ujhhx9W9/FxiQAPEACBsCIwZ84cYRbr+PHjVFJSQlu2bKFt27YZ3gavBYi3xqhbt66oSO1a8DCNNxHjt2BwIAACchFgA5/37t0TUyT8Usnxx0827tyGDRto2rRpFBsbSx06dKAJEyYIizXu4gbi57UAxcTEiLmfBQsW0KZNm8RzIZvLOXDgAE2ZMoXi4+PpscceC6QuSAsCIBAEAnvz82n+/PnUpEkTl9+ePXtcShSGHOy2+HhvdsXxRv3BsM/n9RwQV4SfAVlsfv7zn4t68fMgKyi/rv/ggw8oKSlJqa9Ux+j7RPHXtat0o5F2GIfEXdIO18uXU/X0YNh1/yjtvD2F9PSwRtTmYV1/G52ttm3d9UuPK9EPP5qhH35Ih/nn+kmpw7P6ESbpB2veC1GVHhIGOTj2lv596m/xw/oPphGPPy62O/YmD36i4VFT48aN1ej8tptt9BntfBKgZs2a0caNG6moqEg8F/JCRV54yPM/WAtkdNcgPxAwh0Dz5s1FwfwlhPJ3XVlZKSzUGF0jrx/BlIL5kausrEw8E06dOpWOHTtGeXl5SjCOIAACYU6AbaPx0wz/nSuOzx0fyRT/QI8+CRBvGN+zZ0/au3evWi6/rnvmmWfEOiAetsGBAAiEP4GsrCxatGgR8ciHjYTm5ubS2LFjDW+YzwK0cOFCUTGlJq+88opYK8CTWZs3b1a8cQQBEAhjArNmzaLLly9TamqqGFzw3O/gwYMNb5HXc0BsIqe4uJg+/fRTl0rwDPmgQYOEUioT1C6R4AECIBA2BHgeiK0KX7p0iRISEjRNnwfaIK9HQDwBzc+FvD6gtmNxYgOCeja1a6fBNQiAgPwE+LtPXv8XLOd1zvzK/Re/+AW98cYb6geoPEN+8uRJ4rVB/JrucfurPjgQAAEQ8JaA1wLEGf71r38V6wMmT54s1v8ohXTu3Fm8nlde3yn+OIIACICAHgGfBIitlPKbMJ4d5/kgXrDEk1Tp6elBHabpNQBhIAAC4UvAJwFSmskrJHnxIRwIgAAIBELALwEKpECkBQEQcE/AVkVk0/nsx30qz762m/Y4TT3HMyOG12/BzKgcygQBEIhsAhCgyO5ftA4EpCYAAZK6e1A5EIhsAhCgyO5ftA4EpCYAAZK6e1A5EIhsAtIKUHl5udNix8juBrQOBKxJQDoBWrNmDfHKajbzzJY22BIHHAiAQGQSkGodUHV1Nb388sv02WefUZ8+fcR3Zmx5lfchSU5OjsweQKtAwMIEpBIgNv3D+wux+LDjzzzatWtH//rXv+iXv/ylZjexcN2/b9/42Y3jMJv9PzgQ8IYAW4/grUi1XIMGDfDZkRYcP/ylEiDeXzonJ0dtxtdff00nTpwQJqBVTzcnbI3j22/d77DON1SXzl3cpIIXCLgS2Ldvn655Kd4Z8Mknn3RNaIQP614wLJzbV1jL6qQSIEdIbBBt9OjRYqsPNnyo5/LtZke0HG+qNHfOXK1g+IOAE4GMjAzSu5+cIuMiYALSTUJzi9jI4cCBA4UZaJ4TggMBEIhMAtKNgLZv305jxowRb7/05n0iszvQKhCwFgGpBOjs2bPC6OHSpUvF7oq8Hy27uLg44sk/OBAAgcgiINUj2LJly4QZEN5xkfefVn68CRocCIBA5BGQSoD++Mc/itXPbO7Z8ZednR155NEiEAABkkqA0B8gAALWIgABslZ/o7UgIBUBCJBU3YHKgIC1CECArNXfaC0ISEVAqtfwUpFBZUAgxARsN+yb0uNTjBBTR3EgAAJhQeDOnTtOH32zteT69esHVHc8ggWED4lBwDoE+vXrR2yOXfn17Nkz4MbjESxghMgABCKfAI9+Dh06RN999x098MADosE8AgrUQYACJYj0IGABAiUlJUJ42rdvT3fv3qWYmBhDWg0BMgQjMgEBeQlUXK+g8iM/0JYtW1wqOWDAAGrWrJmLf22PoqIiqlOnjjDJzvt08bbJq1evpl69etWO6tM1BMgnXIgMAuFH4MzlM3Tsu1K6evWqS+V511FvBIg/jeItcpQ92v/whz+ID8dLS0spNjbWJV9vPSBA3pJCPBAIUwLp7dMpo0d/mj17tlct2LNnD40bN06Nu3XrVuIPxPmnuNdff12MgA4ePEi9e/dWvH0+QoB8RoYEIBDZBLp06UJsnUZxKSkptHnzZmratCkNHjxYePMEdHR0tNizXYnnzxEC5A81pAGBCCaQkJBAQ4YMcWphZWUlvfrqq8TzP/zItXjxYhGHt8wJxEGAAqGHtCBgEQLjx4+ngoICSk9Pp5s3b4qN+9evXx9w6y0hQDb73FvNR9qsGuzSDhMhr2mHf9ZIO4xDro7SDx+pH6wbGjVUN9hjYFSidhQ9XpzKU9nHtLMWIT/SCW+qE8ZBmR7C8z2EX9XosyMNPSQMdjBbr7gchEJuBp4nP27xhoE8Cc2T2YmJOjePD8VhJbQPsBAVBKxOoG7duoaJD7OEAFn9jkL7QcBEAhAgE+GjaBCwOgEIkNXvALQfBEwkAAEyET6KBgGrE4AAWf0OQPtBwEQCECAT4aNoELA6AQiQ1e8AtB8ETCQAATIRPooGAasTgABZ/Q5A+0HARAKW+BTDRL4oGgS8J2C3ikEXvI/udcxqr2OGPCJGQCFHjgJBAAQUAhAghQSOIAACIScAAQo5chQIAiCgEIAAKSRwBAEQCDkBCFDIkaNAEAABhYC0AlRTU0NHjx5V6okjCIBABBKQVoB4B/8pU6ZEIHI0CQRAQCEgnQBduXJFmP9YsmSJUkccQQAEIpSAdALEIx82grZ06dIIRY5mgQAIKASkWwnNI58GDRpQbm6uUkePRxar06dPu433ww8/0J07t92GwRMEahMoKyujnJyc2t7q9a9+9Svq1q2beo2TwAhIJ0AsPr46Ni177949t8lu3LhB5VHlbsPgCQK1CdSrV49atGhR21u9DsQMsZqJ1on9kwlbhVag//42iT/FkE6A/MGclZWlmWzHjh10KP+wZjgCQMCRQOvWrWnmzJmOXjgPIgHp5oCC2FZkDQIgIBkBCJBkHYLqgICVCECArNTbaCsISEZAWgGaMGEC5efnS4YL1QEBEDCSgLQCZGQjkRcIgICcBCBAcvYLagUC0hKoqKigCxdct268ffs28bo7XxwEyBdaiAsCFidQVVVFw4cPp/fff9+JxLx586hNmzaUmZlJvXv3pvPnzzuFa11AgLTIwB8EQMCJQGFhIQ0YMIAOH3ZeV7d792569913icNPnDhB6enp9Morrzil1bqAAGmRgT8IgIATgXHjxtELL7xAP/3pT538N27cSGPGjKF27dpR/fr1xULO9evXi286nSK6uYiIldBu2gUvEAg/AmwV46Lx1T5+7jid2vKD23mb6dOnU2pqqleFFhcXi+808/LynOLz93NDhw5V/dq3b083b94knitKTExU/d2dQIDcUYEfCEQQgQbR9al58+aUlpbm0ioesXjrtL7TPHfuHDVu3FjNJj4+Xpzz1joQIBULTkDAmgRax7WhTpkd6aWXXvIKwJ49e4gftxS3detW3R0AWNyuX7+uRFfPW7VqpfppnWAEpEUG/iBgUQJdunShNWvWqK1PSUlRz92d8NwPP4Ypjs+TkpIoLi5O8dI8QoA00SAABKxJICEhgYYMGeJ14ydOnEhPP/00Pfvss8RitXDhQnrmmWe8Sg8B8goTIoEACGgR6N+/v9hGuU+fPtS0aVPq0aMHrVy5Uiu6kz8EyAkHLkAABDwR2LRpk0uU+fPnE2+nfOvWLeIRlLcOAuQtKcQDARDQJcBv1Hx5q8aZYSGiLlIEggAIBJMABCiYdJE3CICALoGIfwTjNQq7Du6kfgv6aoO4qR0kQvZrh1fHaIdxSI1D8B3718Ls6sXGqr5vqme+n0Td9T2NY4ooh39+qqqrxCrXOv/1tPGqXD33ll4g0Q0PXPSCHfdQZ2MDd+/eFXVTSvxAOdE43tfwV7wd+0Tx4+NN+4eWqTob0jvGNfqcVw9nL82m90++Z3TWVFixjz74P0/UDC/Wqwyj7Da4bF7FDONIbOK5srLS9BbwmwHG/dxzz5lel9oVePLJJ8Wbi+Tk5NpBpl5//fXX9Pe//52WLVsWknp07tyZGjVqFJKyHAu5f/8+/fvf/3b0Muy8Tp064gt1wzI0MKOIHwExq06dOhmIzP+sPv30UyFAffvqjMb8zz6glGxu5qGHHhIfFAaUkcGJr127Rk2aNCEZmRnZ1Ojo6IhvozteDoNwd8HwAwEQAIHgEYAABY8tcgYBEPBAAALkARCCQQAEgkcAAhQ8tsgZBEDAAwEIkAdACAYBEAgeAUu8BQsePt9y5m0LZF31wG+Z+E2YbI6/K+rWrZts1UJ9DCJgiXVABrFCNiAAAgYTwCOYwUCRHQiAgPcEIEDes0JMEAABgwlAgAwGiuxAAAS8JwAB8p4VYoIACBhMAAJkMFBkBwIg4D0BCJD3rAKKyYbaHH+8zYTZ7vjx42Kri9r1uHDhAvFHoGa5mpoa4h0MHB1/Le7Ij89lXdLgWG+c6xOAAOnzMSS0tLSUGjZs6PSbN2+eIXn7m0lBQYFYX3Px4v9McVbZ98N55JFHxNYNLVu2pBkzZpjyR857C0+ZMsWpaWxpoTbDkpISpzi4CD8CEKAQ9FlRURENGjSIqqur1d9rr70WgpJdi+BRw/Lly2nkyJF0+78bpCmx5syZQ7wfEI+M+I97y5YttG3bNiU46Ee2pDl58mRasmSJS1nM8E9/+pPKj1l27drVJR48wosABCgE/cV/PGyyhE3b1q1bVz2GoGiXIrZv304rVqygTz75xCVsw4YNNG3aNLEiukOHDjRhwgRat26dS7xgefDIhwVy6dKlLkXs37+fMjIyVH7MMioqyiUePMKLAAQoBP3Ffzy8s1/Hjh2J7WaPHz9eNV8bguKdihg4cCAVFhYKQXQM4G1PT506JQzLKf68TSj7hcrxyGf16tViAzLHMtns78mTJ4XBuxb2LVN5m92//e1vjlFwHqYEIEAh6LjExER66qmn6MCBA7R3714qLi6mWbNmhaBk1yK0zKbwxDNP/jZu3FhNxFuT8mNRqByPaty58+fP09ChQyknJ4fOnTtHb7/9Nr344ou0c+dOd9HhF0YE8DFqCDpr7dq1aim9evWi559/3u1jhhrJhBMeVbDj0QZP9rLjfbRbtWolzs3834MPPkj86Ki4cePGiREQz0/5YkJYSY+jPAQwAgpyX/CjDT9aXLp0SS2J5y5SU1PVaxlOeGSUlJREZWVlanX4PMVu69tsd+TIEXr33XddqiEbQ5cKwsMjAQiQR0SBRYiJiRGPCgsWLBATrGfPnqVVq1bR2LFjA8s4CKmzsrJo0aJFYuRz+PBhys3NlaKeLIzZ2dm0e/du0eodO3bQV199RU8//XQQKCDLUBKAAIWANq9h4X/F09LSiB8neO8d/mOXzfG81OXLl8XobNiwYWItzuDBg02vpjLp/Lvf/Y747RwLD5vq4bk1uPAmgP2AQth/vLqYN/3SmggOYVV0i+LHRd4IjJcMyOZ4spxHRHgFL1vP+FcfCJB/3JAKBEDAAAJ4BDMAIrIAARDwjwAEyD9uSAUCIGAAAQiQARCRBQiAgH8EIED+cUMqEAABAwhAgAyAiCxAAAT8IwAB8o8bUoEACBhAAAJkAERkAQIg4B8BCJB/3JAKBEDAAAIQIAMgIgsQAAH/CECA/OOGVCAAAgYQgAAZABFZgAAI+EcAAuQfN6QCARAwgAAEyACIyAIEQMA/AhAg/7ghFQiAgAEEIEAGQEQWIAAC/hGAAPnHDalAAAQMIAABMgCiDFnk5+fTgAED6PPPP6c2bdoIMza8vSrbVGdDf126dCE2s9OvXz/auHGjWuUxY8bQG2+8oV6zzXWO4+jHJpvZD2ZwVEw4MYgABMggkGZnw9u9svHD3/zmN8TGB9m+V7NmzWju3LnCntbo0aPFJvM9evRQ91TmOrOhv/fee0+tPm/8/s0339D69etVP94Eno0rPvTQQ6ofTkDAEAJ2U7hwEUDAbsfdZr8hbPPnz1dbU15ebrNb5bDZRzOqH5/YLbPa7DbgbXfu3LFt3bpVpLMb/BNx7OaRbXZTPDb7nss2+whK+NnNNdvs9rfEOf4HAkYSwAjIEBmXJxO2IKo4tknPdskmTpyoeIkjW+RgC6MnTpwgtn7BFkm/+OILEcZHtjrK5oQUMzh5eXk0YsQIpzxwAQJGEIAAGUFRojzatm2r1oYNC7L1iNrWTXmOiN3p06eF+LBoseVRnuvhx6+f/OQn1L9/f9q1axd9//33VFpaSiNHjlTzxQkIGEUAAmQUSUnyiY6OVmvC9rTsw2W6evWq6scnFRUV4lqxLPrEE08IAeIRT5MmTahr165iEpsFiEc/HO/HP/6xUx64AAEjCECAjKAoaR785osdTyI7Or6Oj49XzS6zAPHjGFtCZUOEPGriR7PCwkL6+OOP8fjlCA/nhhKAABmKU67M+I3X448/TjNnzqSCggK6ffs2/eMf/xC26l944QXVuB+PcDp16iTehilzSJmZmcSjKcz/yNWnkVYbCFCk9Wit9qxdu5b69OkjXs3zZDO/pv/tb39Lb775plNMHgXdu3dPPHpxAFtvzcjIoLi4ONXPKQEuQMAAArCMagDEcMiCFxjymy+2rQ4HArIQgADJ0hOoBwhYkAAewSzY6WgyCMhCAAIkS0+gHiBgQQIQIAt2OpoMArIQgADJ0hOoBwhYkAAEyIKdjiaDgCwEIECy9ATqAQIWJAABsmCno8kgIAsBCJAsPYF6gIAFCUCALNjpaDIIyEIAAiRLT6AeIGBBAhAgC3Y6mgwCshCAAMnSE6gHCFiQAATIgp2OJoOALAQgQLL0BOoBAhYk8P8zmFagpQ7NRgAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="spatial-models-in-multiple-trials-at-once" class="section level3">
<h3>3) Spatial models in multiple trials at once</h3>
<p>Sometimes we want to fit heterogeneous variance components when e.g., have multiple trials or different locations. The spatial models can also be fitted that way using the <code>at.var</code> and <code>at.levels</code> arguments. The first argument expects a variable that will define the levels at which the variance components will be fitted. The second argument is a way for the user to specify the levels at which the spatial kernels should be fitted if the user doesn’t want to fit it for all levels (e.g., trials or fields).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>DT2 &lt;-<span class="st"> </span><span class="kw">rbind</span>(DT,DT)</span>
<span id="cb16-2"><a href="#cb16-2"></a>DT2<span class="op">$</span>Y &lt;-<span class="st"> </span>DT2<span class="op">$</span>Y <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">length</span>(DT2<span class="op">$</span>Y))</span>
<span id="cb16-3"><a href="#cb16-3"></a>DT2<span class="op">$</span>trial &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;A&quot;</span>,<span class="kw">nrow</span>(DT)),<span class="kw">rep</span>(<span class="st">&quot;B&quot;</span>,<span class="kw">nrow</span>(DT)))</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="kw">head</span>(DT2)</span></code></pre></div>
<pre><code>##   row col         Y   N          V  B         MP R C        fit trial
## 1   1   1  88.63670 0.2    Victory B2    Victory 1 1 -6.8551989     A
## 2   2   1  61.35888   0    Victory B2    Victory 2 1 -9.8822858     A
## 3   3   1 121.69536 0.4 Marvellous B2 Marvellous 3 1 -1.7663567     A
## 4   4   1 144.27135 0.6 Marvellous B2 Marvellous 4 1  4.7259712     A
## 5   5   1 148.28295 0.6 GoldenRain B2 GoldenRain 5 1  6.8147655     A
## 6   6   1 108.12927 0.2 GoldenRain B2 GoldenRain 6 1  0.2831235     A</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># SOMMER MODEL</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>m3.sommer &lt;-<span class="st"> </span><span class="kw">mmer</span>(Y<span class="op">~</span><span class="dv">1</span><span class="op">+</span>V, </span>
<span id="cb18-3"><a href="#cb18-3"></a>                  <span class="dt">random =</span> <span class="op">~</span><span class="kw">vs</span>(<span class="kw">ds</span>(trial),R)<span class="op">+</span><span class="kw">vs</span>(<span class="kw">ds</span>(trial),C)<span class="op">+</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="st">                    </span><span class="kw">spl2Da</span>(col,row, <span class="dt">nsegments =</span> <span class="kw">c</span>(<span class="dv">14</span>,<span class="dv">21</span>), <span class="dt">degree =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">penaltyord =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">at.var =</span> trial),</span>
<span id="cb18-5"><a href="#cb18-5"></a>                  <span class="dt">rcov =</span> <span class="op">~</span><span class="kw">vs</span>(<span class="kw">ds</span>(trial),units),</span>
<span id="cb18-6"><a href="#cb18-6"></a>                  <span class="dt">data=</span>DT2, <span class="dt">tolpar =</span> <span class="fl">1e-6</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="kw">summary</span>(m3.sommer)<span class="op">$</span>varcomp</span></code></pre></div>
<pre><code>##              VarComp VarCompSE    Zratio Constraint
## A:R.Y-Y     105.3782  82.16371 1.2825394   Positive
## B:R.Y-Y     101.1873  81.36410 1.2436362   Positive
## A:C.Y-Y     142.7314 137.26832 1.0397987   Positive
## B:C.Y-Y     144.8012 139.39282 1.0387999   Positive
## A:all.Y-Y   370.3593 890.34802 0.4159713   Positive
## B:all.Y-Y   416.6555 900.96905 0.4624526   Positive
## A:units.Y-Y 400.0223 207.00599 1.9324189   Positive
## B:units.Y-Y 396.4449 208.05697 1.9054633   Positive</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># get the fitted values for the spatial kernel and plot</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>ff &lt;-<span class="st"> </span><span class="kw">fitted.mmer</span>(m3.sommer)</span>
<span id="cb20-3"><a href="#cb20-3"></a>DT2<span class="op">$</span>fit &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">Reduce</span>(<span class="st">&quot;+&quot;</span>,ff<span class="op">$</span>Zu[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)])) </span>
<span id="cb20-4"><a href="#cb20-4"></a>lattice<span class="op">::</span><span class="kw">levelplot</span>(fit<span class="op">~</span>row<span class="op">*</span>col<span class="op">|</span>trial,<span class="dt">data=</span>DT2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="final-remarks" class="section level3">
<h3>Final remarks</h3>
<p>Keep in mind that sommer uses a direct inversion (DI) algorithm which can be very slow for large datasets. The package is focused on problems of the type p &gt; n (more random effect levels than observations) and models with dense covariance structures. For example, for experiments with dense covariance structures with low-replication (i.e. 2000 records from 1000 individuals replicated twice with a covariance structure of 1000x1000) sommer will be faster than MME-based software. Also for genomic problems with large number of random effect levels, i.e. 300 individuals (n) with 100,000 genetic markers (p). For highly replicated trials with small covariance structures or n &gt; p (i.e. 2000 records from 200 individuals replicated 10 times with covariance structure of 200x200) asreml or other MME-based algorithms will be much faster and we recommend you to opt for those. When datasets are big, the installation of the OpenBLAS library can make sommer quite fast and sometimes faster than asreml given the capacbility of sommer to take advantage of the multi-processor architecture of some systems.</p>
</div>
</div>
<div id="literature" class="section level2">
<h2>Literature</h2>
<p>Covarrubias-Pazaran G. 2016. Genome assisted prediction of quantitative traits using the R package sommer. PLoS ONE 11(6):1-15.</p>
<p>Covarrubias-Pazaran G. 2018. Software update: Moving the R package sommer to multivariate mixed models for genome-assisted prediction. doi: <a href="https://doi.org/10.1101/354639" class="uri">https://doi.org/10.1101/354639</a></p>
<p>Bernardo Rex. 2010. Breeding for quantitative traits in plants. Second edition. Stemma Press. 390 pp.</p>
<p>Gilmour et al. 1995. Average Information REML: An efficient algorithm for variance parameter estimation in linear mixed models. Biometrics 51(4):1440-1450.</p>
<p>Henderson C.R. 1975. Best Linear Unbiased Estimation and Prediction under a Selection Model. Biometrics vol. 31(2):423-447.</p>
<p>Kang et al. 2008. Efficient control of population structure in model organism association mapping. Genetics 178:1709-1723.</p>
<p>Lee, D.-J., Durban, M., and Eilers, P.H.C. (2013). Efficient two-dimensional smoothing with P-spline ANOVA mixed models and nested bases. Computational Statistics and Data Analysis, 61, 22 - 37.</p>
<p>Lee et al. 2015. MTG2: An efficient algorithm for multivariate linear mixed model analysis based on genomic information. Cold Spring Harbor. doi: <a href="http://dx.doi.org/10.1101/027201" class="uri">http://dx.doi.org/10.1101/027201</a>.</p>
<p>Maier et al. 2015. Joint analysis of psychiatric disorders increases accuracy of risk prediction for schizophrenia, bipolar disorder, and major depressive disorder. Am J Hum Genet; 96(2):283-294.</p>
<p>Rodriguez-Alvarez, Maria Xose, et al. Correcting for spatial heterogeneity in plant breeding experiments with P-splines. Spatial Statistics 23 (2018): 52-71.</p>
<p>Searle. 1993. Applying the EM algorithm to calculating ML and REML estimates of variance components. Paper invited for the 1993 American Statistical Association Meeting, San Francisco.</p>
<p>Yu et al. 2006. A unified mixed-model method for association mapping that accounts for multiple levels of relatedness. Genetics 38:203-208.</p>
<p>Tunnicliffe W. 1989. On the use of marginal likelihood in time series model estimation. JRSS 51(1):15-27.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
